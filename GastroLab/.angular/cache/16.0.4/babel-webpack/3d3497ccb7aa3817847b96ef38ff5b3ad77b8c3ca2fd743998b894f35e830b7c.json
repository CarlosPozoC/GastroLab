{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/cpozo/OneDrive/Escritorio/TFG/GastroLab/GastroLab/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { compareSync } from 'bcryptjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nclass LoginComponent {\n  constructor(http, router) {\n    this.http = http;\n    this.router = router;\n  }\n  loginUsuario(form) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (form.invalid) {\n        return;\n      }\n      const nombre = form.value.nombre;\n      const contraseña = form.value.contrasena;\n      try {\n        const response = yield _this.http.get('https://localhost:7271/api/usuario').toPromise();\n        const usuarios = response || []; // Manejar el caso en que la respuesta sea undefined\n        const usuario = usuarios.find(u => u.nombre === nombre);\n        if (usuario) {\n          const contraseñaEncriptada = usuario.contrasena;\n          if (compareSync(contraseña, contraseñaEncriptada)) {\n            // Contraseña correcta, redirigir al componente TestpageComponent\n            _this.router.navigate(['/test-page']);\n          } else {\n            // Contraseña incorrecta\n            console.log('Contraseña incorrecta');\n          }\n        } else {\n          // No se encontró ningún usuario con ese nombre\n          console.log('Usuario no encontrado');\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }\n}\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.Router));\n};\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 9,\n  vars: 0,\n  consts: [[1, \"container\"], [3, \"ngSubmit\"], [\"f\", \"ngForm\"], [\"type\", \"text\", \"id\", \"nombre\", \"name\", \"nombre\", \"placeholder\", \"Nombre\", \"ngModel\", \"\", \"required\", \"\"], [\"type\", \"password\", \"id\", \"contrasena\", \"name\", \"contrasena\", \"placeholder\", \"Contrase\\u00F1a\", \"ngModel\", \"\", \"required\", \"\"], [\"type\", \"submit\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r1 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n      i0.ɵɵtext(2, \"Login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"form\", 1, 2);\n      i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_3_listener() {\n        i0.ɵɵrestoreView(_r1);\n        const _r0 = i0.ɵɵreference(4);\n        return i0.ɵɵresetView(ctx.loginUsuario(_r0));\n      });\n      i0.ɵɵelement(5, \"input\", 3)(6, \"input\", 4);\n      i0.ɵɵelementStart(7, \"button\", 5);\n      i0.ɵɵtext(8, \"Iniciar sesi\\u00F3n\");\n      i0.ɵɵelementEnd()()();\n    }\n  },\n  dependencies: [i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm],\n  styles: [\".container[_ngcontent-%COMP%] {\\r\\n  width: 300px;\\r\\n  margin: 100px auto;\\r\\n  padding: 20px;\\r\\n  background-color: #f2f2f2;\\r\\n  border: 1px solid #ccc;\\r\\n  border-radius: 5px;\\r\\n}\\r\\n\\r\\nh2[_ngcontent-%COMP%] {\\r\\n  text-align: center;\\r\\n}\\r\\n\\r\\nform[_ngcontent-%COMP%] {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n}\\r\\n\\r\\ninput[type=\\\"text\\\"][_ngcontent-%COMP%], input[type=\\\"password\\\"][_ngcontent-%COMP%] {\\r\\n  margin-bottom: 10px;\\r\\n  padding: 8px;\\r\\n  border: 1px solid #ccc;\\r\\n  border-radius: 4px;\\r\\n}\\r\\n\\r\\nbutton[_ngcontent-%COMP%] {\\r\\n  padding: 10px 20px;\\r\\n  background-color: #4caf50;\\r\\n  color: white;\\r\\n  border: none;\\r\\n  border-radius: 4px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\nbutton[_ngcontent-%COMP%]:hover {\\r\\n  background-color: #45a049;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbG9naW4vbG9naW4uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQVk7RUFDWixrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLHlCQUF5QjtFQUN6QixzQkFBc0I7RUFDdEIsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLHNCQUFzQjtBQUN4Qjs7QUFFQTs7RUFFRSxtQkFBbUI7RUFDbkIsWUFBWTtFQUNaLHNCQUFzQjtFQUN0QixrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIseUJBQXlCO0VBQ3pCLFlBQVk7RUFDWixZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0IiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcclxuICB3aWR0aDogMzAwcHg7XHJcbiAgbWFyZ2luOiAxMDBweCBhdXRvO1xyXG4gIHBhZGRpbmc6IDIwcHg7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2YyZjJmMjtcclxuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gIGJvcmRlci1yYWRpdXM6IDVweDtcclxufVxyXG5cclxuaDIge1xyXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcclxufVxyXG5cclxuZm9ybSB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG59XHJcblxyXG5pbnB1dFt0eXBlPVwidGV4dFwiXSxcclxuaW5wdXRbdHlwZT1cInBhc3N3b3JkXCJdIHtcclxuICBtYXJnaW4tYm90dG9tOiAxMHB4O1xyXG4gIHBhZGRpbmc6IDhweDtcclxuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxufVxyXG5cclxuYnV0dG9uIHtcclxuICBwYWRkaW5nOiAxMHB4IDIwcHg7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzRjYWY1MDtcclxuICBjb2xvcjogd2hpdGU7XHJcbiAgYm9yZGVyOiBub25lO1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbn1cclxuXHJcbmJ1dHRvbjpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzQ1YTA0OTtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});\nexport { LoginComponent };","map":{"version":3,"names":["compareSync","LoginComponent","constructor","http","router","loginUsuario","form","_this","_asyncToGenerator","invalid","nombre","value","contraseña","contrasena","response","get","toPromise","usuarios","usuario","find","u","contraseñaEncriptada","navigate","console","log","error","i0","ɵɵdirectiveInject","i1","HttpClient","i2","Router","selectors","decls","vars","consts","template","LoginComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","LoginComponent_Template_form_ngSubmit_3_listener","ɵɵrestoreView","_r1","_r0","ɵɵreference","ɵɵresetView","ɵɵelement"],"sources":["C:\\Users\\cpozo\\OneDrive\\Escritorio\\TFG\\GastroLab\\GastroLab\\src\\app\\login\\login.component.ts","C:\\Users\\cpozo\\OneDrive\\Escritorio\\TFG\\GastroLab\\GastroLab\\src\\app\\login\\login.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\nimport { compareSync, hashSync } from 'bcryptjs';\nimport { Router } from '@angular/router';\n\ninterface Usuario {\n  id: number;\n  nombre: string;\n  contrasena: string;\n  sexo: string;\n}\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})\nexport class LoginComponent {\n  constructor(private http: HttpClient, private router: Router) {}\n\n  async loginUsuario(form: NgForm) {\n    if (form.invalid) {\n      return;\n    }\n\n    const nombre = form.value.nombre;\n    const contraseña = form.value.contrasena;\n\n    try {\n      const response = await this.http.get<Usuario[]>('https://localhost:7271/api/usuario').toPromise();\n      const usuarios: Usuario[] = response || []; // Manejar el caso en que la respuesta sea undefined\n\n      const usuario = usuarios.find(u => u.nombre === nombre);\n\n      if (usuario) {\n        const contraseñaEncriptada: string = usuario.contrasena;\n\n        if (compareSync(contraseña, contraseñaEncriptada)) {\n          // Contraseña correcta, redirigir al componente TestpageComponent\n          this.router.navigate(['/test-page']);\n        } else {\n          // Contraseña incorrecta\n          console.log('Contraseña incorrecta');\n        }\n      } else {\n        // No se encontró ningún usuario con ese nombre\n        console.log('Usuario no encontrado');\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n}\n","<div class=\"container\">\n  <h2>Login</h2>\n  <form (ngSubmit)=\"loginUsuario(f)\" #f=\"ngForm\">\n    <input type=\"text\" id=\"nombre\" name=\"nombre\" placeholder=\"Nombre\" ngModel required>\n    <input type=\"password\" id=\"contrasena\" name=\"contrasena\" placeholder=\"Contraseña\" ngModel required>\n    <button type=\"submit\">Iniciar sesión</button>\n  </form>\n</div>\n\n"],"mappings":";AAGA,SAASA,WAAW,QAAkB,UAAU;;;;;AAUhD,MAKaC,cAAc;EACzBC,YAAoBC,IAAgB,EAAUC,MAAc;IAAxC,KAAAD,IAAI,GAAJA,IAAI;IAAsB,KAAAC,MAAM,GAANA,MAAM;EAAW;EAEzDC,YAAYA,CAACC,IAAY;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MAC7B,IAAIF,IAAI,CAACG,OAAO,EAAE;QAChB;;MAGF,MAAMC,MAAM,GAAGJ,IAAI,CAACK,KAAK,CAACD,MAAM;MAChC,MAAME,UAAU,GAAGN,IAAI,CAACK,KAAK,CAACE,UAAU;MAExC,IAAI;QACF,MAAMC,QAAQ,SAASP,KAAI,CAACJ,IAAI,CAACY,GAAG,CAAY,oCAAoC,CAAC,CAACC,SAAS,EAAE;QACjG,MAAMC,QAAQ,GAAcH,QAAQ,IAAI,EAAE,CAAC,CAAC;QAE5C,MAAMI,OAAO,GAAGD,QAAQ,CAACE,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACV,MAAM,KAAKA,MAAM,CAAC;QAEvD,IAAIQ,OAAO,EAAE;UACX,MAAMG,oBAAoB,GAAWH,OAAO,CAACL,UAAU;UAEvD,IAAIb,WAAW,CAACY,UAAU,EAAES,oBAAoB,CAAC,EAAE;YACjD;YACAd,KAAI,CAACH,MAAM,CAACkB,QAAQ,CAAC,CAAC,YAAY,CAAC,CAAC;WACrC,MAAM;YACL;YACAC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;;SAEvC,MAAM;UACL;UACAD,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;;OAEvC,CAAC,OAAOC,KAAK,EAAE;QACdF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;;IACnB;EACH;;AAlCWxB,cAAc,C;mBAAdA,cAAc,EAAAyB,EAAA,CAAAC,iBAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,iBAAA,CAAAG,EAAA,CAAAC,MAAA;AAAA;AAAd9B,cAAc,C;QAAdA,cAAc;EAAA+B,SAAA;EAAAC,KAAA;EAAAC,IAAA;EAAAC,MAAA;EAAAC,QAAA,WAAAC,wBAAAC,EAAA,EAAAC,GAAA;IAAA,IAAAD,EAAA;;MClB3BZ,EAAA,CAAAc,cAAA,aAAuB;MACjBd,EAAA,CAAAe,MAAA,YAAK;MAAAf,EAAA,CAAAgB,YAAA,EAAK;MACdhB,EAAA,CAAAc,cAAA,iBAA+C;MAAzCd,EAAA,CAAAiB,UAAA,sBAAAC,iDAAA;QAAAlB,EAAA,CAAAmB,aAAA,CAAAC,GAAA;QAAA,MAAAC,GAAA,GAAArB,EAAA,CAAAsB,WAAA;QAAA,OAAYtB,EAAA,CAAAuB,WAAA,CAAAV,GAAA,CAAAlC,YAAA,CAAA0C,GAAA,CAAe;MAAA,EAAC;MAChCrB,EAAA,CAAAwB,SAAA,eAAmF;MAEnFxB,EAAA,CAAAc,cAAA,gBAAsB;MAAAd,EAAA,CAAAe,MAAA,0BAAc;MAAAf,EAAA,CAAAgB,YAAA,EAAS;;;;;;SDapCzC,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}